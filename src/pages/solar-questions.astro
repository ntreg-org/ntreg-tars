---
import { useStoryblokApi } from "@storyblok/astro";

import Layout from "../layouts/layout.astro";
import HeroSection from "../components/HeroSection.astro";
import QuestionSection from "../components/QuestionSection.astro";


const storyblokApi = useStoryblokApi();
const version = import.meta.env.DEV ? "draft" : "published";

// Fetch the Solar Contractor Questions page + global nav + global footer
const [{ data: pageData }, { data: navData }, { data: footerData }] =
  await Promise.all([
    storyblokApi.get("cdn/stories/solar-questions", { version }),
    storyblokApi.get("cdn/stories/global-nav", { version }),
    storyblokApi.get("cdn/stories/global-footer", { version }),
  ]);

const pageStory  = pageData.story;
const navBlok    = navData.story?.content;
const footerBlok = footerData.story?.content;

// All blocks on the solar contractor page
const body = Array.isArray(pageStory?.content?.body)
  ? pageStory.content.body
  : [];
  
  const heroBlok = body.find(
    (blok:any) => blok.component === 'hero_section');
  const questionBlok = body.find(
  (blok:any) => blok.component === 'question_section');
---



<Layout
  title="Solar Contractor Questions | NTREG"
  navBlok={navBlok}
  footerBlok={footerBlok}
>
 {heroBlok && <HeroSection blok={heroBlok} />}
  {questionBlok && <QuestionSection blok={questionBlok} />}
  

</Layout>