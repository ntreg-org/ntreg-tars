---
// src/components/HeroSection.astro
import { storyblokEditable } from '@storyblok/astro';

const { blok } = Astro.props;

// Safe reads from Storyblok
const imageUrl =
  blok?.background_image?.filename ?? '';

const scrollLink =
  blok?.scroll_prompt_link?.url ??
  blok?.scroll_prompt_link?.cached_url ??
  '#';

const primary   = blok?.headline_primary   ?? '';
const highlight = blok?.headline_highlight ?? '';
const bodyText  = blok?.body               ?? '';
const promptTxt = blok?.scroll_prompt_text ?? 'Continue Learning';
---

<section id="hero" data-anchor
  class={`hero-section relative bg-cover bg-center text-white overflow-hidden ${
    imageUrl ? '' : 'bg-slate-900'
  }`}
  style={imageUrl ? `background-image:url(${imageUrl});` : undefined}
  {...storyblokEditable(blok)}
>
  <!-- Dark overlay -->
  <div class="hero-section__overlay"></div>

  <!-- Bottom-anchored content wrapper -->
  <div class="hero-section__inner">
    <div class="page-grid w-full pb-16 md:pb-24 lg:pb-[200px]">
      <!-- Headline block -->
      <div class="col-span-12 lg:col-span-9">
        {primary && <h1 class="hero-type hero-white">{primary}</h1>}
        {highlight && (
          <h2 class="hero-type text-brand-highlight">{highlight}</h2>
        )}
      </div>

      <!-- Divider + subcopy + scroll prompt -->
      <div class="col-span-12 mt-5 md:mt-7">
        <!-- divider matches page grid width -->
        <div class="h-px w-full bg-[rgba(255,255,255,0.40)]"></div>

        <!--
          On mobile: stack subcopy over scroll link
          On md+: keep them side-by-side
        -->
        <div class="mt-3 md:mt-5 flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
          {bodyText && (
            <p class="hero-subcopy text-left">
              {bodyText}
            </p>
          )}

          <a href={scrollLink} class="hero-scroll">
            <span>{promptTxt}</span>
            <span class="hero-scroll__icon">â†“</span>
          </a>
        </div>
      </div>

      <!-- Spacer to pull block up from absolute page bottom -->
      <div class="col-span-12 h-[117px]"></div>
    </div>
  </div>
</section>